<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login â€” NEO TECH Solutions</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
  :root {
    --card:#ffffff;
    --text:#22303b;
    --muted:#6f7b83;
    --darkgreen:#00533f;
    --lightgreen:#8fd694;
    --radius:12px;
    --shadow:0 6px 20px rgba(0,0,0,0.06);
    --transition:all 0.3s ease;
  }

  * { box-sizing:border-box; margin:0; padding:0; }

  body {
    font-family:"Inter",sans-serif;
    background:linear-gradient(rgba(0,83,63,0.9), rgba(0,83,63,0.9)), url('https://picsum.photos/seed/office/1200/800.jpg');
    background-size:cover;
    background-position:center;
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
  }

  .login-wrapper {
    display:flex;
    justify-content:center;
    align-items:center;
    width:100%;
    min-height:100vh;
    padding:40px 20px;
  }

  .login-form {
    background:var(--card);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    padding:40px;
    width:100%;
    max-width:400px;
  }

  .form-header {
    text-align:center;
    margin-bottom:30px;
  }
  .form-header img {
    width:80px;
    margin-bottom:15px;
  }
  .form-header h2 {
    font-size:24px;
    font-weight:700;
    color:var(--darkgreen);
    margin-bottom:5px;
  }
  .form-header p {
    color:var(--muted);
    font-size:14px;
  }

  .form-group {
    margin-bottom:20px;
  }
  .form-group label {
    display:block;
    font-weight:600;
    margin-bottom:8px;
    color:var(--text);
  }
  .form-group input {
    width:100%;
    padding:12px 15px;
    border:1px solid #ddd;
    border-radius:8px;
    font-size:16px;
    transition:var(--transition);
  }
  .form-group input:focus {
    border-color:var(--darkgreen);
    outline:none;
    box-shadow:0 0 0 2px rgba(0,83,63,0.2);
  }

  .form-options {
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:20px;
  }
  .remember-me {
    display:flex;
    align-items:center;
    gap:8px;
  }
  .forgot-password {
    color:var(--darkgreen);
    text-decoration:none;
    font-size:14px;
    transition:var(--transition);
  }
  .forgot-password:hover { text-decoration:underline; }

  .login-btn {
    width:100%;
    padding:12px;
    background:var(--darkgreen);
    color:white;
    border:none;
    border-radius:8px;
    font-size:16px;
    font-weight:600;
    cursor:pointer;
    transition:var(--transition);
  }
  .login-btn:hover {
    background:var(--lightgreen);
    color:var(--darkgreen);
  }

  .divider {
    display:flex;
    align-items:center;
    margin:25px 0;
  }
  .divider::before, .divider::after {
    content:"";
    flex:1;
    height:1px;
    background:#ddd;
  }
  .divider span {
    padding:0 15px;
    color:var(--muted);
    font-size:14px;
  }

  .demo-accounts {
    margin-top:15px;
  }
  .demo-accounts h3 {
    font-size:16px;
    margin-bottom:10px;
    color:var(--muted);
  }
  .demo-account {
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:10px;
    background:#f9f9f9;
    border-radius:6px;
    margin-bottom:8px;
    font-size:14px;
  }
  .demo-account button {
    padding:5px 10px;
    background:var(--darkgreen);
    color:white;
    border:none;
    border-radius:4px;
    font-size:12px;
    cursor:pointer;
    transition:var(--transition);
  }
  .demo-account button:hover {
    background:var(--lightgreen);
    color:var(--darkgreen);
  }

  .error-message {
    background:#ffebee;
    color:#ff6347;
    padding:10px;
    border-radius:6px;
    margin-bottom:20px;
    font-size:14px;
    display:none; /* Hidden by default */
  }

  @media (max-width:600px) {
    .login-form { padding:30px 25px; }
  }
</style>
</head>
<body>

<div class="login-wrapper">
  <div class="login-form">
    <div class="form-header">
      <!-- Make sure 'logo-removebg-preview.png' is in the same folder -->
      <img src="./company_logo.jpg" alt="Logo">
      <h2>Sign In</h2>
      <p>Enter your credentials to access your account</p>
    </div>

    <!-- This div will display errors from the backend -->
    <div class="error-message" id="error-message"></div>

    <!-- The form that will trigger our login function -->
    <form id="loginForm">
      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" placeholder="Enter your email" required>
      </div>

      <div class="form-group">
        <label for="password">Password</label>
        <input type="password" id="password" placeholder="Enter your password" required>
      </div>

      <div class="form-options">
        <div class="remember-me">
          <input type="checkbox" id="remember">
          <label for="remember">Remember me</label>
        </div>
        <a href="#" class="forgot-password">Forgot password?</a>
      </div>

      <button type="submit" class="login-btn">Sign In</button>
    </form>

    <div class="divider"><span>OR</span></div>

    <!-- Demo accounts for easy testing -->
    <div class="demo-accounts">
      <h3>Demo Accounts</h3>
      <div class="demo-account">
        <div><strong>HR Admin:</strong> admin@company.com</div>
        <button onclick="loginDemo('admin@company.com','admin123')">Login</button>
      </div>
      <div class="demo-account">
        <div><strong>Management:</strong> management@company.com</div>
        <button onclick="loginDemo('management@company.com','management123')">Login</button>
      </div>
      <div class="demo-account">
        <div><strong>Supervisor:</strong> supervisor@company.com</div>
        <button onclick="loginDemo('supervisor@company.com','supervisor123')">Login</button>
      </div>
      <div class="demo-account">
        <div><strong>Employee:</strong> employee@company.com</div>
        <button onclick="loginDemo('employee@company.com','employee123')">Login</button>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // Add event listener to the form
  document.getElementById('loginForm').addEventListener('submit', e => {
    e.preventDefault(); // Prevent default form submission
    login();
  });
});




async function login() {
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value.trim();
  const errorDiv = document.getElementById('error-message');
  const loginButton = document.querySelector('.login-btn');

  // Basic validation
  if (!email || !password) {
    showError('Please enter both email and password.');
    return;
  }

  // Show loading state on the button
  loginButton.textContent = 'Signing In...';
  loginButton.disabled = true;

  try {
    const response = await fetch('http://127.0.0.1:8000/api/login/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
          // credentials: 'include',
      },
      // The backend expects 'username' but we are using email for it
      body: JSON.stringify({ username: email, password: password }),
    });

    const data = await response.json();

    if (response.ok) {
      // On success, store token and user data in sessionStorage
      sessionStorage.setItem('authToken', data.token);
      sessionStorage.setItem('currentUser', JSON.stringify(data.user));

      // Redirect to the dashboard page
      window.location.href = './dashboard.html';
    } else {
      // On failure, display the error message from the backend
      showError(data.error || 'An unknown error occurred.');
    }
  } catch (error) {
    // Handle network errors
    console.error('Login error:', error);
    showError('Could not connect to the server. Please try again later.');
  } finally {
    // Reset button state
    loginButton.textContent = 'Sign In';
    loginButton.disabled = false;
  }
}


function loginDemo(email, password) {
  document.getElementById('email').value = email;
  document.getElementById('password').value = password;
  login();
}


function showError(message) {
  const errorDiv = document.getElementById('error-message');
  errorDiv.textContent = message;
  errorDiv.style.display = 'block';
  
  setTimeout(() => {
    errorDiv.style.display = 'none';
  }, 5000);
}
</script>
</body>
</html>